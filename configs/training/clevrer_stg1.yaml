# Global Seed
seed: 0

# Datamodule Config
data_module:
  _target_: wiskers.datasets.clevrer.data_module.ClevrerImage
  data_dir: "./datasets"
  batch_size: 4
  num_workers: 2
  preprocessing:
    _target_: wiskers.datasets.clevrer.data_module.PreprocessingConfig
    chunk_size: 16
    stride: 16
    resize: [160, 240]
    limit: null
  transform:
    _target_: wiskers.datasets.clevrer.data_module.TransformConfig
    image_size: [80, 120]

# Logger Configs
tensor_board_logger:
  save_dir: "./experiments"
  name: "clevrer_stg1"
  version: null

# Export Model
export_onnx: True
export_safetensors: True

# Module Config (model and optimizer)
module:
  _target_: wiskers.joint.world_model_module.WorldModelModule
  # model
  in_channels: 3
  out_channels: 3
  num_heads: 0 # A value of 0 implies scaled dot-product attention instead of multihead attention.
  widths: [32, 64, 128, 256]
  attentions: [False, False, False]
  image_size: ${data_module.transform.image_size}  # Use a reference to data_module.image_size
  activation: "nn.ReLU"
  # optimizer
  learning_rate: 1e-4

# Training Configs
earlystopping: False

# lightning.Trainer Config
trainer:
  # Debugging options
  # fast_dev_run: 1        # runs 1 train/val/test batch then quits
  # overfit_batches: 1     # force train/val on the same batch every epoch

  # Batch limits
  limit_train_batches: 1.0   # 1.0 = full dataset, int = exact number of batches
  limit_val_batches: 1.0
  limit_test_batches: 1.0

  # Training schedule
  max_epochs: 100
  log_every_n_steps: 10
